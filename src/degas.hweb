@* Degas include files.

% $Id: 48736de1b71d5d36bfee401e73f9dcd9a3718388 $

\ID{$Id: 48736de1b71d5d36bfee401e73f9dcd9a3718388 $}

The old degas include files (now defined as web sections).

@ The macro definitions. Note that the |TFTR| and |CMOD| options are
not implemented in the Makefile. Since the information specified here
far exceeds the needs of DEGAS 2 (namely, just to read the DEGAS input
file), instead endeavor to modify the default options to suit all 
applications. The idea is to avoid cluttering the Makefile with 
stuff required only for this modest task.

@#if defined(TFTR)
@m TFTR 1
@#else
@m TFTR 0
@#endif

@#if defined(CMOD)
@m CMOD 1
@#else
@m CMOD 0
@#endif

@#if CRAY
@#if CMOD
@m NPPACK 9
@m NPLEN 7
@#else
@m NPPACK 10
@m NPLEN 6
@#endif
@#else
@#if CMOD
@m NPPACK 4
@m NPLEN 7
@#else
@m NPPACK 5
@m NPLEN 6
@#endif
@#endif
@m TASKCOMMON common

@m filelen 40

@m cnpmesg 48

@ The parameter definitions, |pardef.h|.

@f @<pardef.h@> integer

@<pardef.h@>=
      integer
     $     npns,npis,npntyp,nphyd,nph,npv,npt,npptshb,npptsvb,npptskb,
     $     npw,npsegxz,npsegy,npexit,npcel,npdiva,npwtt,nptasks,npcels,nphp1,
     $     npvp1,npws,npwtm,npdiv,npdive,npptsw,npptsww,npdetors,npvp2,npvm1,
     $     nphp2,nptviews,nplambda,npgraf,npwork,npwalmat,npchz,npd,nptp1,
     $     npsegyp1,npht,npvt,npe,npsplit,nprowcol,nphv,npdifa,npdife,npdifzon,
     $     npcos,npgauss,npiso,npdist,npvwdivs,npeh,npdh,nphist,npsimple,
     $     npsmphe,npimp,nptot,nphch,npvch,nptch,npisch,npech

@#if TFTR
      parameter (npns=9,npis=9,npntyp=2,nphyd=3,
     $     nph=34,npv=33,npt=1,npptshb=npv+1,npptsvb=nph+1,npptskb=npt+1,
     $     npw=1,npsegxz=45,npsegy=1,npexit=2,npgraf=100,nptviews=100)
@#else
@#if CMOD
        parameter (npns=5,npis=5,npntyp=2,nphyd=3,
     &   nph=124,npv=28,npt=1,npptshb=npv+1,npptsvb=nph+1,npptskb=npt+1,
     &   npw=6,npsegxz=43,npsegy=1,npexit=1,npgraf=400,nptviews=250)
@#else
        parameter (npns=5,npis=5,npntyp=2,nphyd=3,
     $     nph=124,npv=52,npt=1,npptshb=npv+1,npptsvb=nph+1,npptskb=npt+1,
     $     npw=8,npsegxz=139,npsegy=1,npexit=1,npgraf=100,nptviews=250)
@#endif
@#endif
@#if CRAY
@#if CMOD
        parameter (npcel=40005)
@#else
        parameter (npcel=36005)
@#endif
@#else
@#if CMOD
        parameter (npcel=90001)
@#else
        parameter (npcel=72010)
@#endif
@#endif
      parameter (npdiva=5,npwtt=2,nptasks=16,
     $     npcels=NPPACK*(npcel-1),
     $     nphp1=nph+1,npvp1=npv+1,npws=4,npwtm=1,npdiv=5,npdive=7,
     $     npptsw=npsegxz+1,npptsww=npsegxz*npsegy*npw,npdetors=12,
     $     npvp2=npv+2,npvm1=npv-1,nphp2=nph+2,
     $     nplambda=200,npwork=npgraf*npgraf,
     $     npwalmat=10,npchz=1000,npd=11,nptp1=npt+1,npsegyp1=npsegy+1,
     $     npht=nph*npt,npvt=npv*npt,npe=48,npsplit=81,nprowcol=1000,
     $     nphv=nph*npv,npdifa=7,npdife=12,npdifzon=15,npcos=128,
     $     npgauss=128,npiso=128,npdist=1000,npvwdivs=100,npeh=60,
     $     npdh=15,nphist=7)
      parameter (npsimple=4,npsmphe=npsimple-1,
     $     npimp=13,nptot=npimp+2)
      parameter (nphch=nph,npvch=npv,nptch=npt,npisch=npis,npech=npe)

@ Common block, |combal.h|.

@f @<combal.h@> integer

@<combal.h@>=
      integer ngases,ksource
      common/combal/
     $     ngases,ksource

@ Common block, |comcos.h|.

@f @<comcos.h@> integer

@<comcos.h@>=
      real vcosdist
      integer kcosdst1
      TASKCOMMON/comcos/vcosdist(3,npcos),kcosdst1

@ Common block, |comedit.h|.

@f @<comedit.h@> integer

@<comedit.h@>=
      real xeditnew,xeditold
      integer liniedit
      TASKCOMMON/comedit/xeditnew(3),xeditold(3),liniedit

@ Common block, |comfinz.h|.

@f @<comfinz.h@> integer

@<comfinz.h@>=
      integer lj1,lj2,lj3
      common/comfinz/lj1(12),lj2(12),lj3(12)

@ Common block, |comflg.h|.

@f @<comflg.h@> integer

@<comflg.h@>=
      real
     $     cch2pcx,cch3pcx,cch4pcx,cchpcx,ccpcx,ceccp,cech1,cech2,cech21,
     $     cech22,cech23,cech2p1,cech2p2,cech2p3,cech2p4,cech3,cech31,
     $     cech32,cech33,cech3p1,cech3p2,cech3p3,cech3p4,cech4,cech41,
     $     cech42,cech43,cech4p1,cech4p2,cech4p3,cech4p4,cechp1,cechp2,
     $     cechp3,cecu,cefe,ceh,ceh21,ceh22,ceh23,ceh2r1,ceh2r2,ceh2r3,
     $     cehe,ch2cx,ch4frac,checx1,checx2,cheh2e,chehe,chehee,chepcx,
     $     chp2cx,chpcx,cph2cx,cph2pe,cph2ph2e,cphphee,crandom,cxengs,
     $     dltvint,engymin,fuzz,h2frac,rescale,rratio,rrengy,rrengym,
     $     rscale,scrrmax,shethp,sndspd,tcolcons,thdtol,timemesh,
     $     timloops,version,wt0,wtmin0,xhalamax,xhalamin

      integer
     $     katom,kbkpi,kbkpn,kloc0,kprojspy,ksplevel,kspltwig,kstart,
     $     kstart0,ktype0,ktypei,lbaldur,lchex,lcxonly,ldcal,leh0,lerror,
     $     lflagimp,lflgar,lflgc,lflgch,lflgch2,lflgch3,lflgch4,lflgcu,
     $     lflgfe,lflgh2o,lflghe,lflgo,lflgo2,lflgoh,lmaxwell,lmesh,
     $     loutput,lplanet,lprofh,lproft,lprofv,lpseuprt,lrandom,
     $     lrecycle,lrflct1,lrflct2,lrrulet,lshrtrun,lsputter,lsymetry,
     $     ltimes,ltrail,lunit,lvergrid,maxerrs,mparts,mpis,mpns,mshprt,
     $     ncount,nextra,nhyd,nicharge,nistates,nlsigv,nm,nocxengs,
     $     nodifzon,noflts,nohyds,noimps,noionsp,nolambda,nomolecs,
     $     noneutsp,nosplits,nosplvls,nostates,notasks,notvewdv,nread,
     $     nreadb,nseed,nsplmax,ntty,nwriteb,nwriter

      character*8 l0spec(npns)
      character*72 labeld,labelrun
      character*8 labspec(npns)
      character*filelen lfile,lfileb,lfilef3,lfiler,lfnames(20),lmeshn
      character*3 lflags,lgeomtry,lhalpha,lnamelst,lneutral,lplasma,
     $     lstat,lwall,lwalldst,lsources
      character*8 lispec(npis+3)
      character*cnpmesg msgchn(32)

      common/comflg1/
     $     cecu,cefe,ceh,ceh2r3,ceh2r2,ceh2r1,
     $     ceh23,ceh22,ceh21,cehe,ch2cx,checx2,
     $     checx1,cheh2e,chehee,chehe,chepcx,chp2cx,
     $     chpcx,cph2cx,cph2ph2e,cph2pe,cphphee,
     $     crandom,cxengs(npe),dltvint,engymin,
     $     fuzz,h2frac,ksplevel(npsplit),kspltwig(npsplit),
     $     kstart(3,npptsww),kstart0(2,3),ktype0(npns),ktypei(npis),
     $     katom(nptot),kloc0(npns),kbkpn(npns,10),kbkpi(npis,10),
     $     kprojspy(npns),
     $     lbaldur,lchex,ldcal,leh0,
     $     lerror

      common/comflgc/
     $     l0spec,labeld,labelrun,labspec,
     $     lfile,lfileb,lfilef3,lfiler,lfnames,
     $     lispec,msgchn,lmeshn,
     $     lflags,lgeomtry,lhalpha,lnamelst,lneutral,lplasma,
     $     lstat,lwall,lwalldst,lsources
      common/comflg2/
     $     lcxonly,lmaxwell,lmesh,
     $     loutput,lplanet,
     $     lprofh,lproft,lprofv,lrecycle,
     $     lpseuprt,lrandom,lrflct1,lrflct2,
     $     lrrulet,lshrtrun,lsputter,
     $     lsymetry,ltrail,lunit,lvergrid,maxerrs,
     $     mparts,mpis,mpns,mshprt,
     $     ncount,nhyd(nphyd),
     $     nicharge(npis),nistates(npns),nlsigv,nm,nocxengs,
     $     nodifzon,noflts,
     $     notvewdv,nohyds,noimps,noionsp,nolambda,nomolecs,noneutsp,
     $     nosplits,nosplvls,nostates(nptot),notasks,nread,nreadb,
     $     nseed(nptasks),nsplmax,ntty,nwriteb,nwriter
      common/comflg2r/
     $     rescale(20),rscale,rratio,rrengy,rrengym,scrrmax,shethp,sndspd,
     $     thdtol,timemesh,timloops,version,wt0(npns),wtmin0,
     $     xhalamin,xhalamax
      common/comflg3/
     $     lflagimp(npimp),
     $     lflghe,lflgfe,lflgcu,lflgar,
     $     lflgc,lflgch,lflgch2,lflgch3,lflgch4,
     $     lflgo,lflgoh,lflgh2o,lflgo2,nextra(5)
      common/comflg4/
     $     ch4frac,
     $     ccpcx,cchpcx,cch2pcx,cch3pcx,cch4pcx,
     $     ceccp,
     $     cech1,cech2,cech3,cech4,cechp1,cechp2,cechp3,
     $     cech21,cech22,cech23,cech2p1,cech2p2,cech2p3,cech2p4,
     $     cech31,cech32,cech33,cech3p1,cech3p2,cech3p3,cech3p4,
     $     cech41,cech42,cech43,cech4p1,cech4p2,cech4p3,cech4p4,
     $     tcolcons,ltimes


@ Common block, |comflgrf.h|

@f @<comflgrf.h@> integer

@<comflgrf.h@>=
      integer
     $     l3dgraf,lcontgrf,
     $     lcxanal,lden0,leion,lelect,lfden0,lfpress,lft0,lflight,
     $     lgeom,lhalf,lgrafh,lgrafht,lgrafhv,lgrafhvt,
     $     lgraft,lgrafv,lgrafvt,lion,lpress,
     $     lsion,lstats,lt0,lwallflx,lwalldep,lweion,lweline,lwiion,
     $     msegsplt,niorec,nohbs1,nohbs2,
     $     notbs1,notbs2,novbs1,novbs2,npkhbs,npkvbs
      common/comflgrf/
     $     l3dgraf,lcontgrf,
     $     lcxanal,lden0,leion,lelect,lfden0,lfpress,lft0,lflight,
     $     lgeom,lhalf,lgrafh,lgrafht,lgrafhv,lgrafhvt,
     $     lgraft,lgrafv,lgrafvt,lion,lpress,
     $     lsion,lstats,lt0,lwallflx,lwalldep,lweion,lweline,lwiion,
     $     msegsplt(2,20),niorec,nohbs1,nohbs2,
     $     notbs1,notbs2,novbs1,novbs2,npkhbs(20),npkvbs(20)
      character*8 kbackclr,kcrvclr(20),kcrvtype(20),
     $     kgridclr,kgridtyp,ktrckclr,kwallclr(20)
      character*80 labrun
      common/comflgrc/kbackclr,kcrvclr,kcrvtype,kgridclr,kgridtyp,
     $     ktrckclr,kwallclr,labrun

@ Common block, |comgauss.h|.

@f @<comgauss.h@> integer

@<comgauss.h@>=
      real eta1,eta2
      integer lkgauss,ltgauss
      TASKCOMMON/comgauss/ETA1(npgauss),ETA2(npgauss),LKGAUSS,LTGAUSS

@ Common block, |comgeo.h|.

@f @<comgeo.h@> integer

@<comgeo.h@>=
      real
     $     arcdeg,arcrad,area,areadep,areaxz,areaxzt,cosang,dx,dz,
     $     frabsorb,grfscale,gridx,gridxmax,gridxmin,gridy,gridymax,
     $     gridymin,gridz,gridzmax,gridzmin,rflcoef,rmajor,rminor,sgnvol,
     $     sinang,thetawal,thwalrad,tviewdir,tviewthh,tviewthv,tviewver,
     $     vdetors,volume,volumh,volumht,volumhv,volumhvt,volumt,volumv,
     $     volumvt,walltol,walltri,walplane,walrotat,xcentre,xdetors,
     $     xhaspec1,xhaspec2,xhaspecd,xhaview1,xhaview2,xlen,xplate1,
     $     xplate2,xshift,xwall,ylen,yplate,zlen,zplate1,zplate2,zwall,
     $     psmplane
      integer
     $     kplrecyc,kplsegxz,kplsegy,ksplzone,kwplate,kwrap,kzone1,
     $     kzone2,kzone3,lboun1,lboun2,ltvview,lvolsrc,lwerecom,meshgh,
     $     meshgv,ndifzone,nexit,nocols,nocxdets,nohavews,nohbs,nohzs,
     $     nointvls,norows,nosegsxz,nosegsy,notzs,novbs,novzs,nowals,
     $     nptshb,nptskb,nptsvb,nsegsplt,nwtriint

      common/comgeo1/
     $     arcdeg(nptp1),arcrad(nptp1),areadep(npdifzon),area(npw),
     $     areaxz(npsegxz,npw),areaxzt(npsegxz,npsegy,npw),
     $     cosang(npsegxz,npw),dx,dz,
     $     grfscale,
     $     frabsorb(npsegxz,npsegy,npw,npns),
     $     gridx(npptsvb,npptshb,npptskb),
     $     gridxmax(npptsvb-1,npptshb-1,npptskb-1),
     $     gridxmin(npptsvb-1,npptshb-1,npptskb-1),
     $     gridy(npptsvb,npptshb,npptskb),
     $     gridymax(npptsvb-1,npptshb-1,npptskb-1),
     $     gridymin(npptsvb-1,npptshb-1,npptskb-1),
     $     gridz(npptsvb,npptshb,npptskb),
     $     gridzmax(npptsvb-1,npptshb-1,npptskb-1),
     $     gridzmin(npptsvb-1,npptshb-1,npptskb-1)
      common/comgeo2/
     $     kplrecyc(nph,npv),kplsegy(npptsww),
     $     kplsegxz(npptsww),ksplzone(nph,npv,npt),
     $     kwplate(npptsww),kwrap(3),kzone1(npptsvb,npptshb),
     $     kzone2(npptsvb,npptshb),kzone3(npt),lboun1(npptsvb),
     $     lboun2(npptshb),ltvview,lvolsrc,lwerecom,
     $     meshgh(npgraf,npgraf),
     $     meshgv(npgraf,npgraf),ndifzone(npsegxz,npsegy,npw),nexit,
     $     nocols,nocxdets,nohbs,nohzs,nointvls,nohavews,norows,
     $     nosegsy(npw),nosegsxz(npw),notzs,novbs,novzs,
     $     nowals,nptshb,nptskb,nptsvb,nsegsplt,
     $     nwtriint(npsegxz)
      common/comgeo2r/ psmplane(4,12,nph,npv,npt),
     $     rflcoef(npsegxz,npsegy,npw),
     $     rmajor,rminor,walrotat(3,3,npsegxz)
      common/comgeo3/
     $     sgnvol,sinang(npsegxz,npw),thetawal(npsegyp1,npw),
     $     thwalrad(npsegyp1,npw),
     $     tviewdir(3),tviewthh(2),tviewthv(2),tviewver(3),
     $     vdetors(4,npdetors),
     $     volumhvt(nph,npv,npt),volumt(npt),volumh(nph),
     $     volumv(npv),volumht(nph,npt),volumhv(nph,npv),
     $     volumvt(npv,npt),volume,
     $     walplane(4,npsegxz),walltol,walltri(3,3,npsegxz),
     $     xcentre(3),xdetors(3,npdetors),
     $     xhaspec1(3),xhaspec2(3),xhaspecd,
     $     xhaview1(3,nptviews),xhaview2(3,nptviews),
     $     xlen,xplate1(npptsww),
     $     xplate2(npptsww),xshift,
     $     xwall(npptsw,npw),
     $     ylen,yplate,zlen,zplate2(npptsww),zplate1(npptsww),
     $     zwall(npptsw,npw)

@ Common block, |comgraf.h|.

@f @<comgraf.h@> integer

@<comgraf.h@>=
      real
     $     deltaa,deltacxe,deltacxr,deltathe,deltax,deltay,
     $     delhzone,delvzone,delymax,heit,width,
     $     x3dcoord,
     $     xcxemax,xcxemin,xhmax,xhmin,
     $     xmax,xmin,xcxrmax,xcxrmin,xphyorg,
     $     xtmax,xtmin,xtheta,
     $     xvmax,xvmin,xhzone,xvzone,
     $     y3dcoord,ymax,ymin,
     $     yphyorg
      integer
     $     l3dcoord
      common/comgraf/
     $     deltaa,deltacxe,deltacxr,deltathe,deltax,deltay,
     $     delhzone,delvzone,delymax,heit,l3dcoord,width,
     $     x3dcoord(npgraf,10),
     $     xcxemax,xcxemin,xhmax,xhmin,
     $     xmax,xmin,xcxrmax,xcxrmin,xphyorg,
     $     xtmax,xtmin,xtheta(npt),
     $     xvmax,xvmin,xhzone(100),xvzone(100),
     $     y3dcoord(npgraf,10),ymax,ymin,
     $     yphyorg

@ Common block, |comhits.h|.

@f @<comhits.h@> integer

@<comhits.h@>=
      integer
     $     li,lj,lk
      common/comhits/li(3,12),lj(3,12),lk(3,12)

@ Common block, |comiso.h|.

@f @<comiso.h@> integer

@<comiso.h@>=
      real
     $     VCOSDST1,VCOSDST2,VCOSDST3
      integer
     $     KISOINDX
      TASKCOMMON/comiso/VCOSDST1(npiso),
     $     VCOSDST2(npiso),VCOSDST3(npiso),KISOINDX

@ Common block, |commsh.h|.

@f @<commsh.h@> integer

@<commsh.h@>=
      real
     $     diagtol,xtol,ytol,ztol
      integer
     $     mesh1,mesh2,ncolmn,ncolmx,nrowmn,nrowmx
      common/commsh/
     $     diagtol,
     $     mesh1(npcel),mesh2(npcel),
     $     ncolmn(nprowcol),ncolmx(nprowcol),
     $     nrowmn,nrowmx,xtol,ytol,ztol

@ Common block, |compar.h|.

@f @<compar.h@> integer

@<compar.h@>=
      real
     $     ekptmpe1
      integer
     $     mp0,mp1,mp2,mp3,mpcel,mpcels,mpcos,mpd,mpdetors,mpdh,mpdifa,
     $     mpdife,mpdifzon,mpdist,mpdiv,mpdiva,mpdive,mpe,mpech,mpeh,
     $     mpehm1,mpem1,mpexit,mpgauss,mpgraf,mph,mphch,mphist,mphp1,
     $     mpht,mphv,mphyd,mpimp,mpisch,mpiso,mplambda,mpntyp,mppack,
     $     mpptshb,mpptskb,mpptsvb,mpptsw,mpptsww,mprowcol,mpsegxz,
     $     mpsegy,mpsimple,mpsmphe,mpsplit,mpt,mptasks,mptch,mptot,mptp1,
     $     mptviews,mpv,mpvch,mpvp1,mpvt,mpvwdivs,mpw,mpwalmat,mpwork,
     $     mpws,mpwtm,mpwtt
      common/compar/
     $     ekptmpe1,mp0,mp1,mp2,mp3,
     $     mpcos,mpcels,mpcel,mpd,mpdifa,
     $     mpdife,mpdifzon,mpdetors,
     $     mpdist,mpdiv,mpdiva,mpdive,mpe,mpem1,
     $     mpexit,mpgauss,mpgraf,mph,mphist,mphp1,mpht,mphv,mphyd,
     $     mpimp,mpiso,mplambda,mpntyp,mppack,
     $     mpptskb,mpptsvb,mpptshb,
     $     mpptsww,mpptsw,mprowcol,mpsegy,mpsegxz,mpsimple,mpsmphe,
     $     mpsplit,mpt,mptasks,mptot,mptp1,mptviews,
     $     mpv,mpvp1,mpvt,mpvwdivs,mpw,mpeh,mpdh,
     $     mpehm1,
     $     mpwalmat,mpwork,mpws,mpwtm,mpwtt
      common/compar2/
     $     mphch,mpvch,mptch,mpisch,mpech

@ Common block, |compls.h|.

@f @<compls.h@> integer

@<compls.h@>=
      real
     $     currenti,currentn,currxzt,deneh,deneht,denehv,denehvt,denet,
     $     denev,denevt,deni0,denih,deniht,denihv,denihvt,denit,deniv,
     $     denivt,ewall,fictrr0,fract,h2dish,h2dishv,h2disv,plsang,
     $     plsang1,rinit,rintihvt,t0puff,te0,teh,teht,tehv,tehvt,tet,tev,
     $     tevt,ti0,tih,tiht,tihv,tihvt,tit,tiv,tivt,totcurr,totcurrn,
     $     twall,v0init,vflow,vflowx,vflowy,vflowz,vsorchv,vsorchvt,
     $     vswthvt
      integer
     $     npsi
      common/compls1/
     $     currxzt(npsegxz,npsegy,npw,npis),
     $     currenti(npptsww,npis),currentn(npptsww,npns),
     $     deni0(npis),deneh(nph),deneht(nph,npt),denehv(nph,npv),
     $     denehvt(nph,npv,npt),denet(npt),denev(npv),denevt(npv,npt),
     $     denih(nph,npis),deniht(nph,npt,npis),
     $     denihv(nph,npv,npis),denihvt(nph,npv,npt,npis),
     $     denit(npt,npis),deniv(npv,npis),
     $     denivt(npv,npt,npis),ewall(npsegxz,npsegy,npw),
     $     fictrr0(npns),fract(nphyd),h2dish(nph,npns),
     $     h2dishv(nph,npv,npns),h2disv(npv,npns)
      common/compls2/
     $     npsi(npdist,npns),plsang,plsang1,
     $     rinit(npptsww,npns),rintihvt(nph,npv,npt,npis),t0puff(npns),
     $     te0,teh(nph),teht(nph,npt),tehv(nph,npv),
     $     tehvt(nph,npv,npt),tet(npt),tev(npv),tevt(npv,npt),
     $     tih(nph,npis),tiht(nph,npt,npis),tihv(nph,npv,npis),
     $     tihvt(nph,npv,npt,npis),tit(npt,npis),tiv(npv,npis),
     $     tivt(npv,npt,npis),ti0(npis),totcurr,
     $     totcurrn(npns),twall(npsegxz,npsegy,npw),
     $     v0init(3),vflow(nph,npv,npt),vflowx(nph,npv,npt),
     $     vflowy(nph,npv,npt),vflowz(nph,npv,npt),
     $     vsorchv(nph,npv,npns),vsorchvt(nph,npv,npt,npns),
     $     vswthvt(nph,npv,npt,npns)

@ Common block, |comprof.h|.

@f @<comprof.h@> integer

@<comprof.h@>=
      real
     $     cost,cxprob,cxrr,cxwt,dabsxzt0,dabsxzti,deinth,deinthv,deintt,
     $     deintv,dexcurr,dexcurre,dexspec,dfinth,dfinthv,dfintt,dfintv,
     $     dfprh,dfprhv,dfprt,dfprv,dh2alhvt,dh2alspc,dh2dishv,dh2sphst,
     $     distrang,dpcxxhv,dpcxyhv,dpcxzhv,dpionxhv,dpionyhv,dpionzhv,
     $     dpowchds,dpowcx,dpowdiss,dpowexit,dpowinit,dpowionz,dpowwall,
     $     dprsh,dprshv,dprst,dprsv,dstep,dwa0fxz,dwaifxz,dwaldep0,
     $     dwaldepi,dwall,dwalmom,dwalpwr0,dwldepi0,dwtabsrb,e0,e0new,
     $     ediss,ediss1,ediss2,einew,eionizwt,elediss,eleloss,ethresh,
     $     oabsxzt0,oabsxzti,ocfol,och2fol,och3fol,och4fol,ochfol,
     $     ochreact,ocxskhvt,ocxsrhvt,odstepav,odstepfl,oeichhvt,
     $     oeie0hvt,oeih2hvt,oeinth,oeinthv,oeintt,oeintv,oeionhvt,
     $     oerechvt,oerorat,oerorat0,oexcurr,oexcurre,oexspec,oficthvt,
     $     ofie0hvt,ofinth,ofinthv,ofintt,ofintv,ofprh,ofprhv,ofprt,
     $     ofprv,oh2alhvt,oh2alspc,oh2dishv,oh2sphst,ohalfspc,ohspchst,
     $     opcxxhv,opcxyhv,opcxzhv,opionhvt,opionxhv,opionyhv,opionzhv,
     $     opowchds,opowcx,opowdiss,opowexit,opowinit,opowionz,opowwall,
      real
     $     oprsh,oprshv,oprst,oprsv,orficcfl,orinit,orlmdavg,orpsucfl,
     $     orreacfl,orwalcfl,osseinh,osseinhv,osseint,osseinv,ossexcur,
     $     ossfinh,ossfinhv,ossfint,ossfinv,ossfprh,ossfprhv,ossfprt,
     $     ossfprv,ossprsh,ossprshv,ossprst,ossprsv,ossw0fxz,osswalmm,
     $     osswalpr,osswdep0,osswdepi,osswdept,osswifxz,owa0fxz,owadsxzt,
     $     owaifxz,owaldep0,owaldepi,owalmom,owalp3d,owalp3d0,owalpwr,
     $     owalpwr0,owcxkhvt,owcxrhvt,owechhvt,owedihvt,owedsxzt,
     $     oweizhvt,owelihvt,owichhvt,owidshvt,owie0hvt,owiizhvt,
     $     owl0exzt,owl0fxzt,owldepi0,owliexzt,owlifxzt,owtabsrb,
     $     owtrrkil,owtrrlt,owtrrsav,owtsplit,peioniz,pionizwt,pratio,
     $     prcolisn,pswt,pswtnew,reflcoef,riirr,rlmdamin,rratemx0,
     $     tctrail,thetaint,timee,times,tionizwt,tltrail,totalrr,totcxrr,
     $     totiirr,v,vel,velinew,velnew,velx,vely,velz,vinew,vixnew,
     $     viynew,viznew,vnew,vpnew,vpold,vxnew,vynew,vznew,weight,
     $     wtmintf,wtnew,x0,x0old,xinter,alpha
      integer
     $     k1,k2,k3,ka,ke,keta,khist,khistnew,kicx,kiion,kproblem,
     $     kprojsp,ksegplt,ksegxz,ksegxzo,ksegy,ksi,kspec1,kspec2,ksprt,
     $     kszonew,kszonold,kwall,kwallo,kwallsp,kwprt,kzeta,lerrormc,
     $     lionhit,lnewvel,lnewzone,nbranch,neuspec,neuspec0,neuspnew,
     $     nflight,nijtrail,nionspec,nitrail,nofltsk,nofpchvt,norcohvt,
     $     norpchvt,norrkill,norrsave,nospltot,ntaskno,ntrail
      TASKCOMMON/comtrack/
     $     alpha,cost,cxprob,cxrr(npis),cxwt,distrang,dstep,
     $     dwall,e0,e0new,ediss,ediss1,ediss2,einew,eionizwt,
     $     elediss,eleloss,ethresh,k1,k2,k3,ka,ke,keta,khist,khistnew,
     $     kicx,kiion,kproblem,kprojsp,ksegplt,ksegy,ksegxz,
     $     ksegxzo,ksi,kspec1,kspec2,ksprt,kszonew,kszonold,
     $     kwall,kwallo,kwallsp,kwprt,kzeta,lerrormc,
     $     lionhit,lnewvel,
     $     lnewzone,nbranch,neuspec,neuspec0,neuspnew,nflight,
     $     nionspec,nitrail(10),nijtrail(5,10),nofltsk,ntaskno,ntrail,
     $     tctrail(10),tltrail(10),peioniz,pionizwt,pratio,
     $     prcolisn,pswt,pswtnew,reflcoef,riirr(npis),
     $     rlmdamin,
     $     rratemx0,thetaint,timee,times,tionizwt,totalrr,
     $     totcxrr,totiirr,v(3),vel,velnew,velx,vely,velz,
     $     vinew(3),vixnew,viynew,viznew,velinew,
     $     vnew(3),vpnew,vpold,vxnew,vynew,vznew,weight,
     $     wtmintf,wtnew,x0(3),x0old(3),xinter(3)
      character*72 lerrmsg(10)
      TASKCOMMON/comermsg/
     $     lerrmsg
      TASKCOMMON/comdrat1/
     $     dabsxzt0(npsegxz,npsegy,npw,npns),
     $     dabsxzti(npsegxz,npsegy,npw,npis),
     $     dexcurr(npexit,npns),dexcurre(npexit,npns),
     $     deinthv(nph,npv,npis),deinth(nph,npis),
     $     deintt(npt,npis),deintv(npv,npis),
     $     dexspec(npe,npexit,npns),
     $     dfinthv(nph,npv,npis),
     $     dfinth(nph,npis),dfintt(npt,npis),dfintv(npv,npis),
     $     dfprh(nph,npis),dfprhv(nph,npv,npis),
     $     dfprt(npt,npis),dfprv(npv,npis)
      TASKCOMMON/comdrat2/
     $     dh2dishv(nph,npv,npns),dh2alhvt(nph,npv,npt),
     $     dh2alspc(nplambda),dh2sphst(nplambda,nphist)
      TASKCOMMON/comdrat3/
     $     dpcxxhv(nph,npv,npis),dpcxyhv(nph,npv,npis),
     $     dpcxzhv(nph,npv,npis),
     $     dpionxhv(nph,npv,npis),dpionyhv(nph,npv,npis),
     $     dpionzhv(nph,npv,npis),
     $     dpowchds,
     $     dpowcx,dpowdiss,dpowexit,dpowionz,dpowinit,dpowwall,
     $     dprsh(nph,npis),dprshv(nph,npv,npis),
     $     dprst(npt,npis),dprsv(npv,npis),
     $     dwaldep0(50,npdifzon,npws),dwaldepi(50,npdifzon,npws),
     $     dwldepi0(50,npdifzon,npws),dwa0fxz(npsegxz,npw,npis),
     $     dwaifxz(npsegxz,npw,npis),
     $     dwalpwr0(npsegxz,npw),dwalmom(npsegxz,npw,npns),
     $     dwtabsrb
      TASKCOMMON/comscor1/
     $     oabsxzt0(npsegxz,npsegy,npw,npns),
     $     oabsxzti(npsegxz,npsegy,npw,npis),
     $     ocfol(nphch,npvch,2),ochfol(nphch,npvch,2),
     $     och2fol(nphch,npvch,2),och3fol(nphch,npvch,2),
     $     och4fol(nphch,npvch,2),ochreact(nphch,npvch,32),
     $     ocxskhvt(nph,npv,npt,npis),ocxsrhvt(nph,npv,npt,npis),
     $     odstepav(npns),odstepfl(npns),
     $     oeie0hvt(nph,npv,npt,npns),
     $     nofpchvt(nph,npv,npt,npns),norpchvt(nph,npv,npt,npns),
     $     norcohvt(nph,npv,npt,npns),norrkill(npsplit),
     $     norrsave(npsplit),nospltot(npsplit)
      TASKCOMMON/comscor2/
     $     oeih2hvt(nph,npv,npt,nphyd),oeionhvt(nph,npv,npt,npis),
     $     oexcurr(npexit,npns),oexcurre(npexit,npns),
     $     oeichhvt(nphch,npvch,nptch,npisch),
     $     oeinthv(nph,npv,npis),oeinth(nph,npis),
     $     oeintt(npt,npis),oeintv(npv,npis),
     $     oerorat(npsegxz,npw),oerorat0(npsegxz,npw),
     $     oexspec(npe,npexit,npns),oerechvt(nph,npv,npt,npns),
     $     ofie0hvt(nph,npv,npt,npns),
     $     oficthvt(nph,npv,npt,npns),ofinthv(nph,npv,npis),
     $     ofinth(nph,npis),ofintt(npt,npis),ofintv(npv,npis),
     $     ofprh(nph,npis),ofprhv(nph,npv,npis),
     $     ofprt(npt,npis),ofprv(npv,npis)
      TASKCOMMON/comscor3/
     $     oh2dishv(nph,npv,npns),oh2alhvt(nph,npv,npt),
     $     ohalfspc(nplambda),oh2alspc(nplambda),
     $     ohspchst(nplambda,nphist),oh2sphst(nplambda,nphist),
     $     opcxxhv(nph,npv,npis),opcxyhv(nph,npv,npis),
     $     opcxzhv(nph,npv,npis),
     $     opionhvt(nph,npv,npt,npis),
     $     opionxhv(nph,npv,npis),opionyhv(nph,npv,npis),
     $     opionzhv(nph,npv,npis),
     $     opowchds,
     $     opowcx,opowdiss,opowexit,opowionz,opowinit,opowwall,
     $     oprsh(nph,npis),oprshv(nph,npv,npis),
     $     oprst(npt,npis),oprsv(npv,npis),orinit(npptsww,npns),
     $     orficcfl(npns),orlmdavg(npns),orpsucfl(npns),orreacfl(npns),
     $     orwalcfl(npns)
      TASKCOMMON/comscor4/
     $     ossexcur(npexit,npns),
     $     osseinh(nph,npis),ossfinh(nph,npis),
     $     ossprsh(nph,npis),ossfprh(nph,npis),
     $     osseint(npt,npis),ossfint(npt,npis),
     $     ossprst(npt,npis),ossfprt(npt,npis),
     $     osseinv(npv,npis),ossfinv(npv,npis),
     $     ossprsv(npv,npis),ossfprv(npv,npis),
     $     osseinhv(nph,npv,npis),ossfinhv(nph,npv,npis),
     $     ossprshv(nph,npv,npis),ossfprhv(nph,npv,npis)
      TASKCOMMON/comscor5/
     $     osswalpr(npsegxz,npw),osswalmm(npsegxz,npw,npns),
     $     ossw0fxz(npsegxz,npw,npns),osswifxz(npsegxz,npw,npis),
     $     osswdep0(50,npdifzon,npws),osswdepi(50,npdifzon,npws),
     $     osswdept(50,npdifzon,npws)
      TASKCOMMON/comscor6/
     $     owadsxzt(5,npsegxz,npsegy,npw,npns),
     $     owedsxzt(npe,npsegxz,npsegy,npw,npns),
     $     owaldep0(50,npdifzon,npws),owaldepi(50,npdifzon,npws),
     $     owcxkhvt(nph,npv,npt,npis),owcxrhvt(nph,npv,npt,npis),
     $     owedihvt(nph,npv,npt),
     $     oweizhvt(nph,npv,npt),owelihvt(nph,npv,npt,npns),
     $     owidshvt(nph,npv,npt,npis),owiizhvt(nph,npv,npt,npis),
     $     owie0hvt(nph,npv,npt,npis),
     $     owldepi0(50,npdifzon,npws),owa0fxz(npsegxz,npw,npis),
     $     owaifxz(npsegxz,npw,npis),
     $     owl0exzt(npsegxz,npsegy,npw,npns),owalp3d(npsegxz,npsegy,npw),
     $     owliexzt(npsegxz,npsegy,npw,npis),
     $     owalp3d0(npsegxz,npsegy,npw),owalpwr(npsegxz,npw),
     $     owalpwr0(npsegxz,npw),owalmom(npsegxz,npw,npns),
     $     owechhvt(nphch,npvch,nptch),owichhvt(nphch,npvch,nptch,npisch),
     $     owl0fxzt(npsegxz,npsegy,npw,npns),
     $     owlifxzt(npsegxz,npsegy,npw,npis),
     $     owtabsrb,owtrrkil(npsplit),owtrrlt,owtrrsav(npsplit),
     $     owtsplit(npsplit)

@ Common block, |comran.h|.

@f @<comran.h@> integer

@<comran.h@>=
      integer ran_count,ran_max
      real ran_array(0:2*63-1)
      real ranarray(97)
      integer kran1,kran2,kran3
      TASKCOMMON/comran/ranarray,
     $     ran_array,ran_count,ran_max,kran1,kran2,kran3

@ Common block, |comrat.h|.

@f @<comrat.h@> integer

@<comrat.h@>=
      real
     $     absb,absb0,absbi,absbxz,absbxz0,absbxzi,absbxzt,absbxzt0,
     $     absbxzti,achpr,acpr,cfol,ch2fol,ch3fol,ch4fol,chfol,chreact,
     $     clexcurr,cxionh,cxionht,cxionhv,cxionhvt,cxiont,cxionv,
     $     cxionvt,cxskhv,cxskhvt,cxsrhv,cxsrhvt,cxtion,den0,den0h,
     $     den0ht,den0hv,den0hvt,den0max,den0t,den0v,den0vt,den2hv,
     $     den2hvt,e0cur,eichnhv,eichnhvt,eie0hvt,einh2h,einh2hv,
     $     einh2hvt,einh2v,eion,eionh,eionhv,eionhvt,eionmax,eiont,eionv,
     $     erechvt,erorat01,erorate,erorate0,erorate1,excurr,excurre,
     $     exspec,fden0,fden0h,fden0hv,fden0hvt,fden0t,fden0v,ficthv,
     $     ficthvt,fie0hvt,fpreshvt,fpress,fpressh,fpresshv,fpressv,ft0h,
     $     ft0hv,ft0hvt,ft0t,ft0v,h2alf,h2alfh,h2alfht,h2alfhv,h2alfhvt,
     $     h2alfl,h2alfspc,h2alft,h2alfv,h2alfvt,h2spchst,ha0tview,
     $     ha2tview,HALF,halfh,halfht,halfhv,halfhvt,halfl,halfspec,
     $     halft,halfth,halftht,halfthv,halfthvt,halftl,halftot,halftt,
     $     halftv,halftvt,halfv,halfvt,hatview,hspchist,pcxxhv,pcxyhv
      real
     $     pcxzhv,pionhv,pionhvt,pionxhv,pionyhv,pionzhv,powchdis,powcx,
     $     powdiss,powexit,powinit,powioniz,powwall,press,pressh,presshv,
     $     presshvt,pressv,ptotxhv,ptotyhv,ptotzhv,rionhfh,rionhfhv,
     $     rionhfv,signal,signalln,sion,sionh,sionhv,sionhvt,siont,sionv,
     $     t0h,t0hv,t0hvt,t0v,wadst,wadstn,wadstxz,wadstxzt,wal0exz,
     $     wal0exzt,wal0f,wal0fxz,wal0fxzt,waldep0,waldep0t,waldepi,
     $     waldepi0,waldepit,waliexz,waliexzt,walif,walifxz,walifxzt,
     $     walmomxz,wapow3d,wapow3d0,wapowxz,wapowxz0,wechnhv,wechnhvt,
     $     wedishv,wedishvt,wedst,wedstn,wedstxz,wedstxzt,weinzhv,
     $     weinzhvt,welinhv,welinhvt,welishvt,wetoth,wetothv,wetotv,
     $     wichnhv,wichnhvt,wicx,wicxh,wicxhv,wicxhvt,wicxkhv,wicxkhvt,
     $     wicxrhv,wicxrhvt,wicxv,widishv,widishvt,wiinzhv,wiinzhvt,
     $     wiion,wiionh,wiionhv,wiionv,wine0hv,wine0hvt,witothv,witothvt,
     $     wldepi0t,wtabsorb,wtrrkill,wtrrsave,wtrusrlt,wtsplit
      common/comrat1/
     $     den0hvt(nph,npv,npt,npns),
     $     den2hv(nph,npv,nphyd),den2hvt(nph,npv,npt,nphyd),
     $     eie0hvt(nph,npv,npt,npns),eiont(npt,npis),
     $     eionhvt(nph,npv,npt,npis),eionhv(nph,npv,npis),
     $     erechvt(nph,npv,npt,npns),fden0hvt(nph,npv,npt,npns),
     $     ficthv(nph,npv,npns),ficthvt(nph,npv,npt,npns),
     $     fie0hvt(nph,npv,npt,npns),fpress(npns),h2alf,HALF,
     $     halfthvt(nph,npv,npt),halfthv(nph,npv),halftt(npt),
     $     h2alfh(nph),h2alfv(npv),
     $     h2alfhvt(nph,npv,npt),h2alfhv(nph,npv),h2alft(npt),
     $     halfh(nph),halfhvt(nph,npv,npt),halfhv(nph,npv),halft(npt),
     $     halftot,halfl(nptviews),halfv(npv),h2alfl(nptviews),
     $     halfth(nph),halftv(npv),halftl(nptviews),
     $     ha0tview(nptviews,nptviews),ha2tview(nptviews,nptviews),
     $     hatview(nptviews,nptviews),halfspec(nplambda),
     $     h2alfspc(nplambda),hspchist(nplambda,nphist),
     $     h2spchst(nplambda,nphist)
      common/comrat2/
     $     pcxxhv(nph,npv,npis),
     $     pcxyhv(nph,npv,npis),pcxzhv(nph,npv,npis),
     $     pionxhv(nph,npv,npis),pionyhv(nph,npv,npis),
     $     pionzhv(nph,npv,npis),pionhv(nph,npv,npis),
     $     powcx,powdiss,powexit,powioniz,
     $     powinit,powwall,press(npns),presshv(nph,npv,npns),
     $     ptotxhv(nph,npv,npis),ptotyhv(nph,npv,npis),
     $     ptotzhv(nph,npv,npis),rionhfhv(nph,npv),rionhfh(nph),
     $     rionhfv(npv),sionhv(nph,npv,npis),
     $     wadst(5,npw,npns),wadstn(5,npw,npns),
     $     wadstxz(5,npsegxz,npw,npns),
     $     wadstxzt(5,npsegxz,npsegy,npw,npns),
     $     wedst(npe,npw,npns),wedstn(npe,npw,npns),
     $     wedstxz(npe,npsegxz,npw,npns),
     $     wedstxzt(npe,npsegxz,npsegy,npw,npns),
     $     widishv(nph,npv,nphyd),wine0hv(nph,npv,npis)
      common/comrat3/
     $     absbxz(npsegxz,npw,npns),absbxzt(npsegxz,npsegy,npw,npns),
     $     absb(npw,npns),absb0(npw,npns),
     $     absbi(npw,npis),
     $     absbxz0(npsegxz,npw,npns),absbxzt0(npsegxz,npsegy,npw,npns),
     $     absbxzi(npsegxz,npw,npis),absbxzti(npsegxz,npsegy,npw,npis),
     $     clexcurr(npexit,npns),cxionhv(nph,npv,npis),
     $     cxionh(nph,npis),cxiont(npt,npis),cxionv(npv,npis),
     $     cxionht(nph,npt,npis),cxionvt(npv,npt,npis),
     $     cxskhv(nph,npv,npis),cxsrhv(nph,npv,npis),
     $     den0max(npns),den0hv(nph,npv,npns),den0v(npv,npns),
     $     e0cur(npexit,npns),eionh(nph,npis),
     $     eionv(npv,npis),einh2hv(nph,npv,nphyd),eionmax(npis)
      common/comrat4/
     $     erorate0(npsegxz,npw),erorate(npsegxz,npw),
     $     erorat01(npsegxz,npw),erorate1(npsegxz,npw),
     $     excurre(npexit,npns),excurr(npexit,npns),
     $     exspec(npe,npexit,npns),fpressv(npv,npns),fpressh(nph,npns),
     $     fpresshv(nph,npv,npns),ft0hv(nph,npv,npns),
     $     pressh(nph,npns),
     $     pressv(npv,npns),sionv(npv,npis),sionh(nph,npis),
     $     siont(npt,npis),t0hv(nph,npv,npns),
     $     wedishv(nph,npv),wetoth(nph),wetotv(npv),wicxh(nph,npis),
     $     wicxkhv(nph,npv,npis),wicxrhv(nph,npv,npis),
     $     wicxv(npv,npis),wiionh(nph,npis),wiionv(npv,npis)
      common/comrat5/
     $     cxtion(2,npdetors,nphyd),den0(npns),den0h(nph,npns),
     $     den0ht(nph,npt,npns),den0t(npt,npns),den0vt(npv,npt,npns),
     $     eion(npis),
     $     fden0(npns),fden0h(nph,npns),fden0t(npt,npns),
     $     fden0v(npv,npns),fden0hv(nph,npv,npns),ft0h(nph,npns),
     $     ft0t(npt,npns),
     $     ft0v(npv,npns),halfht(nph,npt),halftht(nph,npt),
     $     h2alfht(nph,npt),h2alfvt(npv,npt),halftvt(npv,npt),
     $     halfvt(npv,npt),
     $     signal(npe,npdetors,nphyd),
     $     signalln(npe,npdetors,npns),sion(npis),
     $     t0h(nph,npns),t0v(npv,npns),
     $     weinzhv(nph,npv),
     $     welinhv(nph,npv),
     $     wetothv(nph,npv),wicx(npis),wicxhv(nph,npv,npis),
     $     witothv(nph,npv,npis),witothvt(nph,npv,npt,npis),
     $     wtabsorb,wtrrkill(npsplit),wtrrsave(npsplit),
     $     wtrusrlt,wtsplit(npsplit)
      common/comrat6/
     $     waldep0(50,npdifzon,npws),waldep0t(npdifzon,npws),
     $     waldepi(50,npdifzon,npws),waldepit(npdifzon,npws),
     $     waldepi0(50,npdifzon,npws),wldepi0t(npdifzon,npws),
     $     wal0exz(npsegxz,npw,npns),wal0exzt(npsegxz,npsegy,npw,npns),
     $     wal0f(npw,npns),
     $     wal0fxz(npsegxz,npw,npns),wal0fxzt(npsegxz,npsegy,npw,npns),
     $     waliexz(npsegxz,npw,npis),waliexzt(npsegxz,npsegy,npw,npis),
     $     walif(npw,npis),
     $     walifxz(npsegxz,npw,npis),walifxzt(npsegxz,npsegy,npw,npis),
     $     walmomxz(npsegxz,npw,npns),
     $     wapowxz0(npsegxz,npw),wapow3d0(npsegxz,npsegy,npw),
     $     wapow3d(npsegxz,npsegy,npw),wapowxz(npsegxz,npw),
     $     wiinzhv(nph,npv,npis),wiion(npis),wiionhv(nph,npv,npis)
      common/comrat7/
     $     cxionhvt(nph,npv,npt,npis),cxskhvt(nph,npv,npt,npis),
     $     cxsrhvt(nph,npv,npt,npis),
     $     einh2h(nph,nphyd),einh2hvt(nph,npv,npt,nphyd),
     $     einh2v(npv,nphyd),
     $     fpreshvt(nph,npv,npt,npns),ft0hvt(nph,npv,npt,npns),
     $     pionhvt(nph,npv,npt,npis),presshvt(nph,npv,npt,npns),
     $     sionhvt(nph,npv,npt,npis),t0hvt(nph,npv,npt,npns),
     $     wedishvt(nph,npv,npt),weinzhvt(nph,npv,npt),
     $     welinhvt(nph,npv,npt),welishvt(nph,npv,npt,npns),
     $     wicxhvt(nph,npv,npt,npis),wicxkhvt(nph,npv,npt,npis),
     $     wicxrhvt(nph,npv,npt,npis),
     $     wiinzhvt(nph,npv,npt,npis),widishvt(nph,npv,npt,nphyd),
     $     wine0hvt(nph,npv,npt,npis)
      common/comrat8/
     $     achpr(4),acpr,chreact(nphch,npvch,32),
     $     cfol(nphch,npvch,2),chfol(nphch,npvch,2),ch2fol(nphch,npvch,2),
     $     ch3fol(nphch,npvch,2),ch4fol(nphch,npvch,2),
     $     eichnhv(nphch,npvch,npisch),eichnhvt(nphch,npvch,nptch,npisch),
     $     powchdis,wechnhv(nphch,npvch),wechnhvt(nphch,npvch,nptch),
     $     wichnhv(nphch,npvch,npisch),wichnhvt(nphch,npvch,nptch,npisch)

@ Common block, |comrfl.h|.

@f @<comrfl.h@> integer

@<comrfl.h@>=
      real
     $     el,rcamar,rcpmar,re0wa85,rengy,rnmar,rnwa85,rvelmar,tsdata
      integer
     $     kwmat1,lrefmod
      common/comrfl/
     $     el(20,2),
     $     kwmat1(npptsw,npw),lrefmod(10),
     $     rcamar(npdiv,npdiv,npdiv,npdiv,npdive,npws,npwtm),
     $     rcpmar(npdiv,npdiv,npdiv,npdive,npws,npwtm),
     $     re0wa85(npe,10,5),
     $     rengy(npdive),
     $     rnmar(npdiv,npdive,npws,npwtm),rnwa85(npe,10,5),
     $     rvelmar(npdiv,npdiv,npdive,npws,npwtm),
     $     tsdata(50,npdiva,npdive,npws,npwtt)
      character*8 kwmat(npptsw,npw),kdifmat(npdifzon)
      common/comrfc/kwmat,kdifmat

@ Common block, |comsplt.h|.

@f @<comsplt.h@> integer

@<comsplt.h@>=
      real
     $     alphaspl,costspl,cxprospl,cxrrspl,cxwtspl,distrspl,dstepspl,
     $     dwallspl,e0newspl,e0spl,eionispl,peinzspl,pionwspl,prcolspl,
     $     pswtspl,reflcspl,riirrspl,rlmdaspl,rratespl,thetaspl,tionispl,
     $     totcxspl,totiispl,totrrspl,velnespl,velspl,velxspl,velyspl,
     $     velzspl,vnewspl,vpnewspl,vpoldspl,vspl,vxnewspl,vynewspl,
     $     vznewspl,weighspl,wtminspl,wtnewspl,x0oldspl,x0spl,xintspl
      integer
     $     k1spl,k2spl,k3spl,kaspl,kespl,ketaspl,khistspl,kicxspl,
     $     kiionspl,kprojspl,ksegyspl,ksgplspl,ksispl,ksnewspl,ksoldspl,
     $     kspe1spl,kspe2spl,kspecspl,ksprtspl,ksxzospl,ksxzspl,kwallspl,
     $     kwalospl,kwalsspl,kwprtspl,kzetaspl,lionhspl,lnvelspl,
     $     lnzonspl,neuspspl,nfltspl,nusnwspl
      TASKCOMMON/comsplt1/
     $     alphaspl(npsplit),costspl(npsplit),cxprospl(npsplit),
     $     cxrrspl(npis,npsplit),cxwtspl(npsplit),
     $     distrspl(npsplit),dstepspl(npsplit),dwallspl(npsplit),
     $     e0spl(npsplit),e0newspl(npsplit),
     $     eionispl(npsplit),
     $     k1spl(npsplit),k2spl(npsplit),
     $     k3spl(npsplit),
     $     kaspl(npsplit),kespl(npsplit),
     $     ketaspl(npsplit),khistspl(npsplit),kicxspl(npsplit),
     $     kiionspl(npsplit),kprojspl(npsplit),ksgplspl(npsplit),
     $     ksegyspl(npsplit),ksnewspl(npsplit),ksoldspl(npsplit),
     $     ksxzspl(npsplit),ksxzospl(npsplit),
     $     ksispl(npsplit),kspe2spl(npsplit),kspe1spl(npsplit),
     $     kspecspl(npsplit),nusnwspl(npsplit),ksprtspl(npsplit),
     $     kwallspl(npsplit),kwalospl(npsplit),kwalsspl(npsplit),
     $     kwprtspl(npsplit),kzetaspl(npsplit),lionhspl(npsplit),
     $     lnvelspl(npsplit),lnzonspl(npsplit)
      TASKCOMMON/comsplt2/
     $     neuspspl(npsplit),
     $     nfltspl(npsplit),peinzspl(npsplit),pionwspl(npsplit),
     $     prcolspl(npsplit),pswtspl(npsplit),reflcspl(npsplit),
     $     riirrspl(npis,npsplit),rlmdaspl(npsplit),
     $     rratespl(npsplit),thetaspl(npsplit),tionispl(npsplit),
     $     totrrspl(npsplit),totcxspl(npsplit),totiispl(npsplit),
     $     vspl(3,npsplit),velspl(npsplit),velnespl(npsplit),
     $     velxspl(npsplit),
     $     velyspl(npsplit),velzspl(npsplit),vnewspl(3,npsplit),
     $     vpnewspl(npsplit),vpoldspl(npsplit),vxnewspl(npsplit),
     $     vynewspl(npsplit),vznewspl(npsplit),weighspl(npsplit),
     $     wtminspl(npsplit),wtnewspl(npsplit),x0spl(3,npsplit),
     $     x0oldspl(3,npsplit),xintspl(3,npsplit)

@ Common block, |comst.h|.

@f @<comst.h@> integer

@<comst.h@>=
      real
     $     a32,adiffuse,atwt,atwthyd,atwttogm,degrad,degskev,e32,
     $     ediffuse,eioniz,epsilon0,ergevinv,ergsev,hydmass,pi,protmass,
     $     raddeg,refmass,refmass0,rionmass,rmasshyd,rneumass,torccevi,
     $     wallamu,wallrho,wallz,wattsev
      integer
     $     nspecz
      common/comst/
     $     a32,adiffuse(npdifa+1),atwt(nptot),atwthyd(3),atwttogm,
     $     degrad,degskev,e32,
     $     ediffuse(npdife+1),eioniz(nptot),
     $     epsilon0,ergevinv,ergsev,hydmass,
     $     pi,protmass,raddeg,refmass(nptot),
     $     refmass0(nptot),rionmass(npis),rmasshyd(3),
     $     rneumass(npns),torccevi,
     $     wallamu(npwalmat),wallrho(npwalmat),wallz(npwalmat),
     $     wattsev,nspecz(nptot)

@ Common block, |comstat.h|.

@f @<comstat.h@> integer

@<comstat.h@>=
      real
     $     cleish,cleishv,cleist,cleisv,clfish,clfishv,clfist,clfisv,
     $     clfprh,clfprhv,clfprt,clfprv,clprsh,clprshv,clprst,clprsv,
     $     clwa0fxz,clwaifxz,clwalmom,clwalpwr,clwdep0,clwdepi,clwdepi0,
     $     dstepavg,dstepflt,einth,einthv,eintt,eintv,finth,finthv,fintt,
     $     fintv,fprsh,fprshv,fprst,fprsv,prsh,prshv,prst,prsv,rficcflt,
     $     rlmdaavg,rpsucflt,rreacflt,rwalcflt,sseinh,sseinhv,sseint,
     $     sseinv,ssexcurr,ssfinh,ssfinhv,ssfint,ssfinv,ssfprh,ssfprhv,
     $     ssfprt,ssfprv,ssprsh,ssprst,ssprsthv,ssprsv,sswa0fxz,sswaifxz,
     $     sswalmxz,sswalpwr,sswdep0,sswdepi,sswdepi0,stdeihv,stdfihv,
     $     stdfphv,stdprhv,tfac,wgpart,wtionz,wtkild
      integer
     $     nfac,nfpcs,nfpcsh,nfpcshv,nfpcshvt,nfpcst,nfpcsv,nrcol,nrcolh,
     $     nrcolhv,nrcolhvt,nrcolt,nrcolv,nrpcs,nrpcsh,nrpcshv,nrpcshvt,
     $     nrpcst,nrpcsv,nrrkills,nrrsaves,nspltot,ntpcs,ntpcsh,ntpcshv,
     $     ntpcshvt,ntpcst,ntpcsv
      common/comstat1/
     $     dstepavg(npns),dstepflt(npns),
     $     einth(nph,npis),einthv(nph,npv,npis),eintt(npt,npis),
     $     eintv(npv,npis),finth(nph,npis),finthv(nph,npv,npis),
     $     fintt(npt,npis),fintv(npv,npis),
     $     fprsh(nph,npis),fprshv(nph,npv,npis),
     $     fprst(npt,npis),fprsv(npv,npis),
     $     nfpcs(npns),nfpcshvt(nph,npv,npt,npns),
     $     nfpcsh(nph,npns),nfpcshv(nph,npv,npns),
     $     nfpcst(npt,npns),nfpcsv(npv,npns)
      common/comstat2/
     $     ntpcsh(nph,npns),ntpcshv(nph,npv,npns),
     $     ntpcst(npt,npns),ntpcsv(npv,npns),
     $     ntpcshvt(nph,npv,npt,npns),ntpcs(npns),nrcol(npns),
     $     nrcolh(nph,npns),nrcolhv(nph,npv,npns),
     $     nrcolhvt(nph,npv,npt,npns),
     $     nrcolt(npt,npns),nrcolv(npv,npns),
     $     nrpcs(npns),nrpcsh(nph,npns),nrpcshv(nph,npv,npns),
     $     nrpcshvt(nph,npv,npt,npns),
     $     nrpcst(npt,npns),nrpcsv(npv,npns),
     $     nrrkills(npsplit),nrrsaves(npsplit),nspltot(npsplit)
      common/comstat2r/
     $     prsh(nph,npns),prshv(nph,npv,npns),
     $     prst(npt,npns),prsv(npv,npns),
     $     rficcflt(npns),rlmdaavg(npns),rpsucflt(npns),
     $     rreacflt(npns),rwalcflt(npns)
      common/comstat3/
     $     cleishv(nph,npv,npis),cleish(nph,npis),
     $     cleist(npt,npis),cleisv(npv,npis),
     $     clfishv(nph,npv,npis),clfish(nph,npis),
     $     clfist(npt,npis),clfisv(npv,npis),
     $     clfprh(nph,npis),clfprhv(nph,npv,npis),
     $     clfprt(npt,npis),clfprv(npv,npis),
     $     clprsh(nph,npis),clprshv(nph,npv,npis),
     $     clprst(npt,npis),clprsv(npv,npis),clwdep0(50,npdifzon,npws),
     $     clwdepi(50,npdifzon,npws),clwdepi0(50,npdifzon,npws),
     $     clwa0fxz(npsegxz,npw,npis),clwalpwr(npsegxz,npw),
     $     clwaifxz(npsegxz,npw,npis),
     $     clwalmom(npsegxz,npw,npns),
     $     sseinhv(nph,npv,npis),sseinh(nph,npis),
     $     ssexcurr(npexit,npns),
     $     sseint(npt,npis),sseinv(npv,npis),
     $     ssfinhv(nph,npv,npis),ssfinh(nph,npis),
     $     ssfint(npt,npis),ssfinv(npv,npis),nfac(21)
      common/comstat4/
     $     ssfprh(nph,npis),ssfprhv(nph,npv,npis),
     $     ssfprt(npt,npis),ssfprv(npv,npis),
     $     ssprsh(nph,npis),ssprsthv(nph,npv,npis),
     $     ssprst(npt,npis),ssprsv(npv,npis),sswdep0(50,npdifzon,npws),
     $     sswdepi(50,npdifzon,npws),sswdepi0(50,npdifzon,npws),
     $     sswa0fxz(npsegxz,npw,npis),sswalmxz(npsegxz,npw,npns),
     $     sswaifxz(npsegxz,npw,npns),
     $     sswalpwr(npsegxz,npw),stdeihv(nph,npv,npis),
     $     stdfihv(nph,npv,npis),stdfphv(nph,npv,npis),
     $     stdprhv(nph,npv,npis),tfac,wgpart(npns),
     $     wtionz(npis),wtkild(npns)

@ Common block, |comsv.h|.

@f @<comsv.h@> integer

@<comsv.h@>=
      real
     $     apne21,apne22,apne31,apne32,aprate,avline1,avline2,dehptinv,
     $     dekptinv,dhkpt,dkpt,drefmax,drefmin,ehkpt,ekpt,erefmax,
     $     erefmin,ficrrhvt,pne21,pne22,pne31,pne32,rcrathvt,rindehvt,
     $     rinhdhvt,rinhthvt,rintehvt,rratemax,rrech,rrech2,rrech3,
     $     rrech4,rreh2,rreion,rrelehvt,svch2pcx,svch3pcx,svch4pcx,
     $     svchpcx,svcpcx,sveccp,svech,svech2,svech2p,svech3,svech3p,
     $     svech4,svech4p,svechp,sveh,sveh2,sveh2r,svehe,sveimp,svh2opcx,
     $     svhecx,svheh2e,svhehe,svhehee,svhepx,svo2pcx,svohpcx,svopcx,
     $     svp2cx,svph2e,svph2x,svphcx,svphe,svphee,tcoli,tcolih,tcoliv,
     $     tcoltot,welms1,welms2,wsveh,wsveh0
      integer
     $     nindexde,nindexte,nindexti,nindxhde,nindxhte
      common/comsv1/
     $     apne21(nph,npv,npt),apne22(nph,npv,npt),apne31(nph,npv,npt),
     $     apne32(nph,npv,npt),aprate(npe),avline1(nph,npv,npt,npns),
     $     avline2(nph,npv,npt,npns),dekptinv,dkpt(npd),drefmax,drefmin,
     $     ekpt(npe),erefmax,erefmin,ficrrhvt(nph,npv,npt,npns),
     $     nindexde(nph,npv,npt),nindexte(nph,npv,npt),
     $     nindexti(nph,npv,npt,npis),
     $     nindxhde(nph,npv,npt),nindxhte(nph,npv,npt)
      common/comsv1r/dehptinv,dhkpt(npdh),ehkpt(npeh),
     $     rinhthvt(nph,npv,npt),rinhdhvt(nph,npv,npt),pne21(npeh,npdh),
     $     pne31(npeh,npdh),pne22(npeh,npdh),pne32(npeh,npdh),
     $     rcrathvt(nph,npv,npt,nphyd),rindehvt(nph,npv,npt),
     $     rintehvt(nph,npv,npt),rratemax(npe,21,npns),
     $     rreh2(nph,npv,npt,10),rreion(nph,npv,npt,npntyp),
     $     rrelehvt(nph,npv,npt,npntyp),svehe(npe),sveh(npe),
     $     sveh2(npe,3),sveh2r(npe,3),sveimp(npe,npsmphe),
     $     svheh2e(npe,npe,2),svhehe(npe,npe,2),svhehee(npe,npe,2),
     $     svhepx(npe,npe),svhecx(npe,npe,2),svp2cx(npe,npe),
     $     svphcx(npe,npe),svph2x(npe,npe),svphe(npe,npe),
     $     svph2e(npe,npe),svphee(npe,npe),welms1(npeh,npdh),
     $     welms2(npeh,npdh),wsveh0(npeh,npdh),wsveh(npeh,npdh)
      common/comsv2/
     $     rrech(nphch,npvch,nptch,7),rrech2(nphch,npvch,nptch,7),
     $     rrech3(nphch,npvch,nptch,7),rrech4(nphch,npvch,nptch,7),
     $     svcpcx(npech,npech),svchpcx(npech,npech),
     $     svch2pcx(npech,npech),svch3pcx(npech,npech),
     $     svch4pcx(npech,npech),
     $     sveccp(npech),svech(npech,4),svechp(npech,3),
     $     svech2(npech,3),svech2p(npech,4),
     $     svech3(npech,3),svech3p(npech,4),
     $     svech4(npech,3),svech4p(npech,4),
     $     svh2opcx(npech,npech),
     $     svo2pcx(npech,npech),svohpcx(npech,npech),svopcx(npech,npech),
     $     tcoli(nphch,npvch,4),tcoltot(nphch,npvch),
     $     tcolih(nphch,4),tcoliv(npvch,4)

@ Common block, |comtrat.h|.

@f @<comtrat.h@> integer

@<comtrat.h@>=
      real
     $     tabsxzt0,tabsxzti,tcfol,tch2fol,tch3fol,tch4fol,tchfol,
     $     tchreact,tcxskhvt,tcxsrhvt,tden2hvt,teichhvt,teie0,tein2hvt,
     $     teionhvt,terorat0,terorate,texcure,texcurr,texspec,tficthvt,
     $     tfie0hvt,tgetxzt,th2afhvt,th2dishv,thalfhvt,tpcxxhv,tpcxyhv,
     $     tpcxzhv,tpionhvt,tpionxhv,tpionyhv,tpionzhv,tpowchds,tpowcx,
     $     tpowdiss,tpowexit,tpowinit,tpowiniz,tpowwall,twadsxzt,
     $     twaldep0,twaldepi,twalmomn,twapowxz,twapw3d,twapw3d0,twapwxz0,
     $     twcxkhvt,twcxrhvt,twechhvt,twedihvt,twedsxzt,tweizhvt,
     $     twelihvt,twichhvt,twidihvt,twie0hvt,twinzhvt,twl0exzt,twl0fxz,
     $     twl0fxzt,twldepi0,twliexzt,twlifxz,twlifxzt
      common/comtrat1/
     $     tcxskhvt(nph,npv,npt,npis),tcxsrhvt(nph,npv,npt,npis),
     $     teionhvt(nph,npv,npt,npis),tein2hvt(nph,npv,npt,nphyd),
     $     tficthvt(nph,npv,npt,npns),tfie0hvt(nph,npv,npt,npns),
     $     thalfhvt(nph,npv,npt),th2afhvt(nph,npv,npt),
     $     th2dishv(nph,npv,npns),tpcxxhv(nph,npv,npis),
     $     tpcxyhv(nph,npv,npis),
     $     tpcxzhv(nph,npv,npis),tpionhvt(nph,npv,npt,npis),
     $     tpionxhv(nph,npv,npis),tpionyhv(nph,npv,npis),
     $     tpionzhv(nph,npv,npis),tpowinit,tpowdiss,
     $     tpowiniz,tpowcx,tpowwall,tpowexit,
     $     teie0(nph,npv,npt,npns),
     $     twcxkhvt(nph,npv,npt,npis),twcxrhvt(nph,npv,npt,npis),
     $     twedihvt(nph,npv,npt),tweizhvt(nph,npv,npt),
     $     twelihvt(nph,npv,npt),
     $     twidihvt(nph,npv,npt,nphyd),twie0hvt(nph,npv,npt,npis),
     $     tden2hvt(nph,npv,npt,nphyd),twinzhvt(nph,npv,npt,npis)
      common/comtrat2/
     $     tabsxzt0(npsegxz,npsegy,npw,npns),
     $     terorat0(npsegxz,npw),terorate(npsegxz,npw),
     $     tabsxzti(npsegxz,npsegy,npw,npis),
     $     texcure(npexit,npns),texcurr(npexit,npns),
     $     texspec(npe,npexit,npns),tgetxzt(npsegxz,npsegy,npw,npns),
     $     twl0fxzt(npsegxz,npsegy,npw,npns),
     $     twaldep0(50,npdifzon,npws),
     $     twaldepi(50,npdifzon,npws),twldepi0(50,npdifzon,npws),
     $     twadsxzt(5,npsegxz,npsegy,npw,npns),
     $     twedsxzt(npe,npsegxz,npsegy,npw,npns),
     $     twl0exzt(npsegxz,npsegy,npw,npns),twl0fxz(npsegxz,npw,npns),
     $     twlifxz(npsegxz,npw,npis),twlifxzt(npsegxz,npsegy,npw,npis),
     $     twliexzt(npsegxz,npsegy,npw,npis),
     $     twapwxz0(npsegxz,npw),twapw3d(npsegxz,npsegy,npw),
     $     twapowxz(npsegxz,npw),twapw3d0(npsegxz,npsegy,npw),
     $     twalmomn(npsegxz,npw,npns)
      common/comtrat3/
     $     tchreact(nphch,npvch,32),
     $     tcfol(nphch,npvch,2),tchfol(nphch,npvch,2),
     $     tch2fol(nphch,npvch,2),
     $     tch3fol(nphch,npvch,2),tch4fol(nphch,npvch,2),
     $     tpowchds,
     $     teichhvt(nphch,npvch,nptch,npisch),
     $     twichhvt(nphch,npvch,nptch,npisch),
     $     twechhvt(nphch,npvch,nptch)

@ Common block, |comtv.h|.

@f @<comtv.h@> integer

@<comtv.h@>=
      real
     $     tvcosh,tvcosv,tvrotmat,tvsinh,tvsinv
      common/comtv/tvcosh(nptviews),tvcosv(nptviews),
     $     tvrotmat(3,3),
     $     tvsinh(nptviews),tvsinv(nptviews)

@ Common block, |comview.h|.

@f @<comview.h@> integer

@<comview.h@>=
      real
     $     x3dview
      common/comview/
     $     x3dview(3)
